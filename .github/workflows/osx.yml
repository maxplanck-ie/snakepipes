name: osx

on: [pull_request, push]

defaults:
  run:
      shell: bash -l {0}

jobs:
  createEnvs_OSX:
    strategy:
      fail-fast: false
      matrix:
        envs: [
          'CONDA_SHARED_ENV',
          'CONDA_CREATE_INDEX_ENV',
          'CONDA_RNASEQ_ENV',
          'CONDA_RMATS_ENV',
          'CONDA_scRNASEQ_ENV',
          'CONDA_seurat3_ENV',
          'CONDA_loompy_ENV',
          'CONDA_alevinqc_ENV',
          'CONDA_eisaR_ENV',
          'CONDA_DNA_MAPPING_ENV',
          'CONDA_CHIPSEQ_ENV',
          'CONDA_ATAC_ENV',
          'CONDA_HIC_ENV',
          'CONDA_WGBS_ENV',
          'CONDA_DSS_ENV',
          'CONDA_RMD_ENV',
          'CONDA_PREPROCESSING_ENV',
          'CONDA_NONCODING_RNASEQ_ENV',
          'CONDA_SAMBAMBA_ENV',
          'CONDA_pysam_ENV'
        ]
    runs-on: macos-latest
    steps:
      - uses: actions/checkout@v4
      - uses: conda-incubator/setup-miniconda@v3
        with:
          environment-file: .github/conda_ci.yml
          activate-environment: conda_ci
          condarc-file: .github/condarc.yml
      - name: install snakePipes_OSX
        run: |
          pip install .
      - name: createEnvsOSX
        run: |
          conda config --set subdir osx-64
          snakePipes createEnvs --only ${{matrix.envs}}
     
